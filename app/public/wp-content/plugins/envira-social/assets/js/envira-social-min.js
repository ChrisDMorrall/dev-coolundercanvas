!function($,e,i){function a(e,i){e=e.replace(/[\[\]]/g,"\\$&");var a=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)"),o=a.exec(i);return o?o[2]?decodeURIComponent(o[2].replace(/\+/g," ")):"":null}function o(e){var i=["doing_wp_cron","envira_social_gallery_id","envira_social_gallery_item_id","rand","envira","envira_album","album_id"];return e=n(e,"doing_wp_cron"),e=n(e,"envira_social_gallery_id"),e=n(e,"envira_social_gallery_item_id"),e=n(e,"rand"),e=n(e,"envira"),e=n(e,"envira_album"),e=n(e,"album_id")}function n(e,i){var a=e.split("?");if(a.length>=2){for(var o=encodeURIComponent(i)+"=",n=a[1].split(/[&;]/g),l=n.length;l-- >0;)-1!==n[l].lastIndexOf(o,0)&&n.splice(l,1);return e=a[0]+(n.length>0?"?"+n.join("&"):"")}return e}var l=!1,t=null,r=null,s=null;$(function(){$(i).on("envirabox_api_before_show",function(){t=null,r=null,s=null}),$(i).on("envirabox_api_after_show",function(e,i,a,o){t=i,r=a,s=o,$(".envirabox-position-overlay").css("z-index","1"),$(".envirabox-position-overlay").css("position","absolute"),$(".envirabox-position-overlay").css("visibility","visible"),$(".envirabox-position-overlay").css("opacity","1"),void 0!==l&&!1!==l||(l=$(".envirabox-inner div.envira-social-buttons-exterior")),console.log(s),l.prependTo(s.$content).addClass("social-active")}),$(i).on("click",".envirabox-inner .envira-social-buttons a",function(i){if(void 0!==t.data.album_id)var n="album",l=$.trim(t.id),r=3187;else var n="gallery",r=$.trim(t.id),l=!1;var c=e.location.hash,g=$(this).attr("href"),_=$(this).parent().data("width"),d=$(this).parent().data("height"),v=$(this).parent().data("network"),p=$(this).parent().data("deeplinking"),u="";if(envira_pagination_page=!1,envira_lb_image=$("img.envirabox-image").attr("src"),envira_gallery_item_id=!1,envira_gallery_item_title=!1,envira_gallery_item_caption=!1,envira_gallery_item_src=!1,envira_gallery_item_full_size=!1,link_source=$(".envirabox-wrap"),rand=Math.floor(1e4*Math.random()+1),envira_permalink=a("envira",e.location.href),"gallery"==n){envira_gallery_item_id=s.enviraItemId,envira_gallery_item_title=s.enviraCaption,envira_gallery_item_caption=s.caption,envira_gallery_item_src=s.src;var m=t.data.social_email_image_size;""!==m&&void 0!==m?(envira_gallery_item_full_size=s.link,envira_gallery_item_id in t.images&&void 0!==t.images[envira_gallery_item_id][m]&&(envira_gallery_item_full_size=t.images[envira_gallery_item_id][m])):envira_gallery_item_full_size=s.link}else{if("album"!=n)return;envira_gallery_item_id=s.id,envira_gallery_item_title=s.title,envira_gallery_item_caption=s.caption,envira_gallery_item_src=s.src;var m=t.data.social_email_image_size;""!==m&&void 0!==m?(envira_gallery_item_full_size=s.link,m in s&&(envira_gallery_item_full_size=s[m])):envira_gallery_item_full_size=s.link}$(".envira-pagination").length>0&&(envira_pagination_page=a("page",$(this).attr("href")),envira_pagination_page||(envira_pagination_page=$(this).closest(".envira-gallery-wrap").find(".envira-pagination").data("page"),envira_pagination_page||(envira_pagination_page=$("img.envirabox-image").data("pagination-page")))),void 0!==envira_pagination_page&&!1!==envira_pagination_page&&(u=envira_pagination_page+"/"),"undefined"!=typeof envira_permalink&&null!==envira_permalink?envira_permalink="envira="+envira_permalink:envira_permalink="","undefined"!=typeof envira_gallery_item_full_size&&null!==envira_gallery_item_full_size||(envira_gallery_item_full_size=envira_gallery_item_src),envira_social.debug&&(console.log("detected gallery_id (lightbox):"+r),console.log("detected gallery_item_id (lightbox):"+envira_gallery_item_id),console.log("detected hash:"+c),console.log("detected envira_permalink:"+envira_permalink)),void 0===y&&(w=""),void 0===w&&(w="");var h=c.length>0?e.location.href.split("#")[0]:e.location.href.split("?")[0];switch(envira_social.debug&&console.log("base_link (lightbox):"+h),h=o(h),envira_social.debug&&console.log("base_link cleaned (lightbox):"+h),envira_permalink&&(envira_permalink="&"+envira_permalink),link=c.length>0?h+"?envira_album_id="+l+"&envira_social_gallery_id="+r+"&envira_social_gallery_item_id="+envira_gallery_item_id+"&rand="+rand+envira_permalink+c:h+u+"?envira_album_id="+l+"&envira_social_gallery_id="+r+"&envira_social_gallery_item_id="+envira_gallery_item_id+"&rand="+rand+envira_permalink,v){case"facebook":var b="",f="",y="",k="";void 0!==$(this).attr("data-envira-social-facebook-text")&&(f=decodeURIComponent($(this).data("envira-social-facebook-text")),f=f.replace(new RegExp("\\+","g")," "),""==$.trim(f)&&(f=" "),envira_social.debug&&(console.log("updating facebook_text"),console.log(f))),void 0!==$(this).attr("data-envira-facebook-quote")&&(b=decodeURIComponent($(this).data("envira-facebook-quote")),b=b.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating quote"),console.log(b))),void 0!==$(this).attr("data-envira-title")&&(y=decodeURIComponent($(this).data("envira-title")),y=y.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating title"),console.log(y))),void 0!==$(this).attr("data-facebook-tags-manual")?(k=decodeURIComponent($(this).data("facebook-tags-manual")),k=k.replace(new RegExp("\\+","g")," "),k=k.replace(/-/g,""),envira_social.debug&&(console.log("updating tags"),console.log(y))):envira_social.debug&&(console.log("updating tags - missing"),console.log($(".envirabox-wrap").find("img.envirabox-image").data("envira-facebook-tags-manual"))),g="https://www.facebook.com/dialog/feed?app_id="+envira_social.facebook_app_id+"&display=popup&link="+link+"&picture="+envira_gallery_item_src+"&name="+y+"&caption="+w+"&description="+f+"&redirect_uri="+link+"#envira_social_sharing_close";break;case"twitter":var x="";void 0!==$(this).attr("data-envira-social-twitter-text")&&(x=decodeURIComponent($(this).data("envira-social-twitter-text")),x=x.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating twitter_text"),console.log(x))),envira_social.debug&&(console.log("updating twitter_text"),console.log(x),console.log("caption"));var w=w.replace(/"/g,"&quote;");g="https://twitter.com/intent/tweet?text="+encodeURIComponent($.trim($.trim(w)+" "+$.trim(x)))+"&url="+encodeURIComponent(link),envira_social.debug&&(console.log("twitter url (lightbox):"),console.log(g));break;case"google":g="https://plus.google.com/share?url="+encodeURIComponent(link),envira_social.debug&&(console.log("google url (lightbox):"),console.log(g));break;case"pinterest":g="http://pinterest.com/pin/create/button/?url="+link+"&media="+envira_gallery_item_full_size+"&description="+w,envira_social.debug&&(console.log("pinterest url (lightbox):"),console.log(g));break;case"email":if(envira_social.debug&&(console.log("envira_permalink (lightboxx):"),console.log(envira_permalink),console.log(envira_permalink.length)),"undefined"!=typeof envira_permalink&&null!==envira_permalink&&envira_permalink.length>0)var R=c.length>0?h+"?"+envira_permalink+c:h+u+"?"+envira_permalink;else var R=c.length>0?h+c:h+u;g="mailto:?subject="+encodeURIComponent(w)+"&body=Photo: "+envira_gallery_item_full_size+"%0D%0AURL: "+R,envira_social.debug&&(console.log("email url (lightbox):"),console.log(envira_gallery_item_full_size),console.log(g),console.log(link));break}if("pinterest"===v){"undefined"==typeof description&&void 0!==w?description=w:"undefined"==typeof description&&(description="");var U=null;PinUtils.pinOne({media:envira_gallery_item_full_size,description:description,url:link})}else if("facebook"===v){if(c.length>0)var C=link;else if(link.length>0)var C=link;else var C=e.location.href;envira_social.debug&&(console.log("sending facebook link:"),console.log(C)),C=$.trim(C),C=C.replace(/(\r\n|\n|\r)/gm,""),FB.ui({method:"share",display:"popup",href:C,title:y,description:f,caption:w,picture:envira_gallery_item_full_size,hashtag:k,quote:b}),clicked=!0}else if("email"===v)e.location=g;else{var I=e.open(g,"Share","width="+_+",height="+d);envira_social.debug&&(console.log("url:"),console.log(g),console.log(encodeURIComponent(g)))}return envira_social.debug&&console.log("link (lightbox):"+link),envira_social.debug&&(console.log("envira_gallery_item_id"),console.log(envira_gallery_item_id),console.log("full_size_image url (lightbox):"),console.log(envira_gallery_item_full_size),console.log("src"),console.log(envira_gallery_item_src),console.log("title"),console.log(envira_gallery_item_title),console.log("caption"),console.log(envira_gallery_item_caption),console.log("envira_permalink"),console.log(envira_permalink),console.log("----")),!1}),$(i).on("click",".envira-gallery-wrap .envira-social-buttons a",function(i){i.preventDefault();var o=e.location.hash,n=$(this).attr("href"),l=$(this).parent().data("width"),t=$(this).parent().data("height"),r=$(this).parent().data("network"),s=$(this).parent().data("deeplinking"),c="",g=!1;if($(".envira-pagination").length>0&&((g=a("page",$(this).attr("href")))||(g=$(this).closest(".envira-gallery-wrap").find(".envira-pagination").data("page"))||(g=$("img.envirabox-image").data("pagination-page"))),g)var c=g+"/";var _=$(this).data("envira-gallery-id"),d=$(this).data("envira-item-id"),v=Math.floor(1e4*Math.random()+1),p=a("envira",e.location.href);if(envira_social.debug&&(console.log("detected gallery_id (gallery): "+_),console.log("detected gallery_item_id (gallery): "+d)),void 0!==$(this).attr("data-envira-album-id")){var u=$(this).data("envira-album-id");envira_social.debug&&(console.log("album_id is currently:"),console.log(u))}else var u=!1;switch(p=void 0!==p&&null!==p?"envira="+p:"",envira_social.debug&&console.log("envira_permalink:"+p),r){case"facebook":var m="",h="",b="",f="",y="",k="";if(void 0!==$(this).attr("data-envira-social-facebook-text")&&(h=decodeURIComponent($(this).data("envira-social-facebook-text")),h=h.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating facebook_text:"),console.log(h))),void 0!==$(this).attr("data-envira-caption")){var y=decodeURIComponent($(this).data("envira-facebook-caption"));y=y.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating caption:"),console.log(y))}void 0!==$(this).attr("data-envira-facebook-quote")&&(m=decodeURIComponent($(this).data("envira-facebook-quote")),m=m.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating quote:"),console.log(m))),void 0!==$(this).attr("data-envira-title")&&(b=decodeURIComponent($(this).data("envira-title")),b=b.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating title:"),console.log(b))),void 0!==$(this).attr("data-envira-facebook-tags")&&(f=decodeURIComponent($(this).data("envira-facebook-tags")),f=f.replace(new RegExp("\\+","g")," "),f=f.replace(/-/g,""),envira_social.debug&&(console.log("updating tags:"),console.log(f))),void 0!==$(this).attr("data-envira-social-picture")&&(k=decodeURIComponent($(this).data("envira-social-picture")),k=k.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating image:"),console.log(k)));var x=o.length>0?e.location.href.split("#")[0]+encodeURIComponent(o)+"&envira_album_id="+u+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+d:e.location.href.split("?")[0]+c+"?envira_album_id="+u+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+d+"&rand="+v+"&"+p;break;case"pinterest":var w="",R="pin-one",k="";void 0!==$(this).attr("data-envira-social-pinterest-description")&&(w=decodeURIComponent($(this).data("envira-social-pinterest-description")),w=w.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating pinterest description"),console.log(w))),void 0!==$(this).attr("data-envira-social-picture")&&(k=decodeURIComponent($(this).data("envira-social-picture")),k=k.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating pinterest image"),console.log(k))),void 0!==$(this).attr("data-envira-pinterest-type")&&(R=decodeURIComponent($(this).data("envira-pinterest-type")),R=R.replace(new RegExp("\\+","g")," "),envira_social.debug&&(console.log("updating pinterest ptype"),console.log(R)));var x=o.length>0?e.location.href.split("#")[0]+encodeURIComponent(o)+"&envira_album_id="+u+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+d+"&"+p:e.location.href.split("?")[0]+"?envira_album_id="+u+"&envira_social_gallery_id="+_+"&envira_social_gallery_item_id="+d+"&rand="+v+"&"+p;envira_social.debug&&(console.log("pinterest link:"),console.log(k));break}if("pinterest"===r)void 0===w&&void 0!==y?w=y:void 0===w&&(w=""),void 0!==R&&"pin-all"==R?PinUtils.pinAny({media:k,description:w,url:x}):PinUtils.pinOne({media:k,description:w,url:x});else if("facebook"===r){if(o.length>0)var U=x;else if(x.length>0)var U=x;else var U=e.location.href;envira_social.debug&&(console.log("sending facebook link:"),console.log(U)),FB.ui({method:"share",display:"popup",href:U,title:b,description:h,caption:y,picture:k,hashtag:f,quote:m})}else if("email"===r)e.location=n;else{var C=e.open(n,"Share","width="+l+",height="+t);envira_social.debug&&(console.log("url:"),console.log(n),console.log(encodeURIComponent(n)))}return!1}),$("div.envira-gallery-item-inner").each(function(){0===$(this).find(".envira-social-buttons .envira-social-network").length&&$(this).find("div.envira-social-buttons").remove()}),location.href.search("envira_social_sharing_close")>-1&&e.close()}),i.getElementsByClassName("button-facebook").onclick=function(){FB.ui({method:"share",display:"popup",href:"https://developers.facebook.com/docs/"},function(e){})}}(jQuery,window,document);